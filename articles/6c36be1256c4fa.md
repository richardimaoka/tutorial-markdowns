---
title: "コピペで学ぶチュートリアル: GitHub Pull Request の update手法(ボタン)を試す"
emoji: "🐷"
type: "tech" # tech: 技術記事 / idea: アイデアh" # tech: 技術記事 / idea: アイデア
topics: ["git"]
published: false
---

## 導入

GitHub の pull request では、base ブランチの変更を取り込んで pull request の同期を維持するために、 Update with merge commit と Update with rebase という 2 つの方法があります。

![update with merge commit](/images/6c36be1256c4fa/update-with-merge-commit.png)

これら 2 つの方法は、上画像のようにトグルボタンひとつで切り替えられますが、base ブランチの変更を取り込む際は当然どちらか一方を選ばないといけません。

- [GitHub 公式: ベース ブランチと pull request の同期の維持](https://docs.github.com/ja/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/keeping-your-pull-request-in-sync-with-the-base-branch)
- [GitHub blog: More ways to keep your pull request branch up-to-date](https://github.blog/changelog/2022-02-03-more-ways-to-keep-your-pull-request-branch-up-to-date/)

手を動かして動作確認すると知識の整理もでき、場面に応じてどちらを選ぶか判断しやすくなると思いますので、本記事ではほぼコピペで貼り付けるだけで簡単に手順を再現できるようにしています。

:::details merge conflict がある場合の 解決手法との区別

本記事で対象とするのは pull request に merge conflict がない場合のみ適用できる手法です。merge conflict が発生しているときに解決する手法とは区別してください。後者については以下を参考にしてください。

- [GitHub 公式: GitHub でのマージ コンフリクトを解決する](https://docs.github.com/ja/pull-requests/collaborating-with-pull-requests/addressing-merge-conflicts/resolving-a-merge-conflict-on-github)
- [GitHub 公式: コマンド ラインを使用してマージ コンフリクトを解決する](https://docs.github.com/ja/pull-requests/collaborating-with-pull-requests/addressing-merge-conflicts/resolving-a-merge-conflict-using-the-command-line)
- [コピペで学ぶチュートリアル: GitHub Pull Request の merge conflict 解決手法を試す](./34aefc43a988ca)

:::

:::details pull request のマージ手法との区別

本記事で対象とするのは pull request『内』で merge conflict を解決する手法なので、pull request 自体を base ブランチへと merge する手法とは区別してください。後者については以下を参考にしてください。

- [GitHub 公式: コマンド ラインを使用してマージ コンフリクトを解決する](https://docs.github.com/ja/pull-requests/collaborating-with-pull-requests/incorporating-changes-from-a-pull-request/about-pull-request-merges)
- [コピペで学ぶチュートリアル: GitHub Pull Request 3 種類の merge 手法を試す](./f20aee8979292d)

:::

```sh:コピペして実行
cat << EOF > pull-req-update-with-merge.txt
a

b

c
EOF
git add --all
git commit -m "create pull-req-update-with-merge.txt"
git push origin developer
```

```txt:pull-req-update-with-merge.txt
a

b

c
```

```sh:コピペして実行
git switch -c pr-update-with-merge
sed -i 's/a/aaaaa/' pull-req-update-with-merge.txt # ファイル中のaをaaaaaに置き換え
git add --all
git commit -m "update a in pr-update-with-merge"
```

```sh:コピペして実行
git push --set-upstream origin pr-update-with-merge
gh pr create --title pr-update-with-merge --body "" --base developer --head pr-update-with-merge
```

![base branch up to date](/images/6c36be1256c4fa/base-branch-up-to-date.png)

```sh:コピペして実行
git switch developer
sed -i 's/b/bbbbb/' pull-req-update-with-merge.txt # ファイル中のbをbbbbbに置き換え
git add --all
git commit -m "update b in developer"
git push origin developer
```

![update with merge commit](/images/6c36be1256c4fa/update-with-merge-commit.png)

![git log update with merge commit](/images/6c36be1256c4fa/git-log-update-with-merge.png)

```
git log --oneline --decorate --graph
```

```log:git log
* 6261845 (HEAD -> developer) Merge branch 'developer' into pr-update-with-merge
|\
| * 973896c update b in developer
* | 9378326 (origin/pr-update-with-merge) update a in pr-update-with-merge
|/
* 58cfed0 create pull-req-update-with-merge.txt
```

![git log pr merged 1](/images/6c36be1256c4fa/git-log-pr-merged-1.png)

```
git log --oneline --decorate --graph
```

```log:git log
*   c02aa4b (HEAD -> developer, origin/developer) Merge pull request #12 from richardimaoka/pr-update-with-merge
|\
| *   6261845 Merge branch 'developer' into pr-update-with-merge
| |\
| |/
|/|
* | 973896c update b in developer
| * 9378326 (origin/pr-update-with-merge) update a in pr-update-with-merge
|/
* 58cfed0 create pull-req-update-with-merge.txt
```

![update with rebase](/images/6c36be1256c4fa/update-with-rebase.png)
